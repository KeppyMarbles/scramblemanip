<!DOCTYPE html>
<html lang="en">
<body style="background-color:#e3eeff;">
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Scramble Optimizer</title>
      <link rel="stylesheet" href="styles.css">
  </head>
  <div class="container">
      <div class="left-section">
          <h2>Scramble</h2>
          <div>
            <label>Scramble
              <input type="text" id="scramble" placeholder="Enter scramble" value="B' D' L F R B R D R U F2 L2 B2 U' L2 D2 F2 D L2 U'", style="width: 350px;"/>
            </label>

            <label title="If double moves can be replaced with a wide move + normal face move. Increases search time">Wide Replace Double
              <input type="checkbox" id="wideReplaceDouble" checked/>
            </label>

            <label title="If a the search should be tried on every orientation">Search Starting Rotations
              <input type="checkbox" id="searchRotations" checked/>
            </label>
          </div>

          <button id="submitButton">Submit</button>
          <p id="errorMessage" style="font-size: 1rem; color: #ff0000;"></p>
          <div>
              <p id="output" style="font-size: 2rem; font-family: monospace;"></p>
          </div>

          <div>
            <button id="toggleAdvanced" class="section-button">Computation Settings ▸</button>
            <div id="advancedContent" class="hidden">

              <label title="Number of iterations to try on each orientation before bailing out">Max Iterations
                <input type="number" id="iterations" value="999999"/>
              </label>

              <label title="The most the current cost can be above the best cost before pruning the branch. Increase this if you have negative cost values">Pruning Threshold
                <input type="number" id="depth" value="2"/>
              </label>

              <label title="If a rotation search should stop if worse than the best rotation. Disable if you want more data">Prune Starting Rotations
                <input type="checkbox" id="pruneRotations" checked/>
              </label>

              <label title="If reaching an already visited state [current grip & scramble index & cube orientation] should prune the current branch. Disable if you want to ensure minimization">Memoize
                <input type="checkbox" id="memoize" checked/>
              </label>
            </div>
          </div>

          <h3>Cost Distribution</h3>
          <div id="myChart" style="width:500px;height:300px;"></div>

          <table class="stats-table">
            <tr><th>Total Samples</th><td id="samples"></td></tr>
            <tr><th>Average Cost</th><td id="averageCost"></td></tr>
            <tr><th>Standard Deviation</th><td id="standardDeviation"></td></tr>
            <tr><th>Skewness</th><td id="skewness"></td></tr>
            <tr><th>Min Z-Score</th><td id="minZ"></td></tr>
          </table>
      </div>
      <div class="middle-section">
          <h2>Rotations</h2>
          <table class="breakdown-table" id="rotationTable">
            <thead>
              <tr><th>Rotation</th><th>Iterations</th><th>Best Cost</th>
            </thead>
            <tbody></tbody>
          </table>

          <table class="stats-table" id="searchTimeTable">
            <tr><th>Search Time</th><td id="searchTime"></td></tr>
          </table>

      </div>
      <div class="right-section">   
          <h2>Breakdown</h2>
          <table class="breakdown-table" id="costTable">
            <thead>
              <tr><th>Move</th><th>Next Grip</th><th>Fingertrick</th><th>Cost</th></tr>
            </thead>
            <tbody></tbody>
          </table>
      </div>
      <div class="cost-section">   
          <form id="costForm" class="cost-form">
            <h2>Cost Configuration</h2>
            <div class="tabs">
              <div class="tab-buttons">
                <button type="button" class="active" data-tab="general">General</button>
                <button type="button" data-tab="face">Move</button>
                <button type="button" data-tab="grip">Thumb Placement</button>
                <button type="button" data-tab="fingertricks">Fingertricks</button>
              </div>
                <div class="tab-content active" id="general">
                  <label>Regrip <input type="number" step="0.5" name="regrip"></label>
                  <label title="Effective only if Wide Replace Double is active">Double Move <input type="number" step="0.5" name="double"></label>
                  <label title="The cost of doing the same fingertrick twice in a row">Repeat Fingertrick Penalty <input type="number" step="0.5" name="repeatPenalty"></label>
                </div>
                <div class="tab-content" id="face" data-group="alpha"></div>
                <div class="tab-content" id="grip" data-group="grip"></div>
                <div class="tab-content" id="fingertricks" data-group="fingertrick"></div>
            </div>
          </form>
          <div style="text-align: end; vertical-align: bottom;">
            <button id="toggleConfig" class="section-button">Config Options ▸</button>
            <div id="configOptions" class="hidden">
              <div >
                <button type="button" id="resetSavedButton">Reset To Saved</button>
                <button type="button" id="resetDefaultButton">Reset To Defaults</button>
              </div>
              <p></p>
              <div class="config-buttons" style="text-align: end;">
                <button id="saveButton" type="button">Save</button>
                <button id="exportButton" type="button">Export</button>
                <button id="importButton" type="button">Import</button>
                <input id="importFile" type="file" accept=".json" style="display:none;">
              </div>
            </div>
          </div>
      </div>
    <footer class="footer-fixed">
      <a href="https://github.com/KeppyMarbles/scramblemanip"
         target="_blank" rel="noopener noreferrer">
        <img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/github.svg"
             alt="GitHub" style="width:20px; vertical-align:middle; margin-right:4px;">Source
      </a>
    </footer>
  </div>
</body>

<script type="module" src="main.js"></script>
<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
